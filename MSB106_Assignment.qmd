---
title: "MSB106 - Assignment"
author: "Sindre H. Øveraas, Alen Colakovic, Mona Lisa Jones & Sebastian M. Fløysand"
format:
 pdf:
  fontsize: "10"
  documentclass: article
  margin-left: 2cm
  margin-right: 2cm
papersize: A4
editor: visual
---

```{r, message=FALSE}
library(rgdal)
library(dplyr)
library(RSQLite)
library(sf)
library(tidyverse)
library(readr)
library(ggplot2)
library(kableExtra)
```

```{r, message=FALSE}
NOR_CBD <- read_csv("NOR_CBD.csv")
Dist_CBD_Dentist <- read_csv("Dist_CBD_Dentist.csv")
Zonal_CBD <- read_csv("Zonal_CBD.csv")
Dist_Mal_Dentist <- read.csv("Dist_Mal_Dentist.csv")
NOR_OSM_SHOP_MAL <- read.csv("NOR_OSM_SHOP_MAL.csv")
Zonal_Den <- read.csv("Zonal_Den.csv")
NOR_KOMM <- read_csv("NOR_KOMM.csv")
NOR_KOMM_2 <- read_csv("NOR_KOMM_2.csv")
```

```{r}
Commune_Data <- inner_join(NOR_KOMM, NOR_KOMM_2, by = "kommunenummer") |>
  select(kommunenummer, HubName, HubDist, Turnover_capita_retail_Omsetning) |>
  rename("knr" = kommunenummer, "DistMal" = HubDist, "HubNameMal" = HubName, "Turnover_capita_retail" = Turnover_capita_retail_Omsetning)
```

```{r}
Dentist_Data <- inner_join(Dist_Mal_Dentist, Dist_CBD_Dentist, by = "fid") |>
  select(fid, Juridisk.n, Antall.ans, Sum.Drifts, Sum.salgsi, Driftsresu.y, osm_id.y, latlong.y, HubName.y, HubDist.y, HubName.x, HubDist.x) |>
  rename("DistMal" = HubDist.x, "DistCBD" = HubDist.y, "HubNameMal" = HubName.x, "HubNameCBD" = HubName.y, "Driftsres" = Driftsresu.y, "osm_id" = osm_id.y, "latlong" = latlong.y)
```

## Introduction

Our main task in this assignment is to perform an analysis of geospatial determinants of firm activity.
More specifically we are to focus on the Norwegian dental industry in this regard, and see how geospatial determinants such as distances to shopping malls and CBDs (Central Business Districts), as well as population density can determine dental businesses income and general financial operations.
As an example, central questions in this assignment will be; "Is it more beneficial to be highly centralized in urban areas with high population density and many competitors, or is it a greater advantage to be less centralized to the advantage that the nearest competing company is considerably further away?", "Which determinants appear to be most significant for economic benefit?"

## Theoretical Foundation of Hypothesis

## Data description

```{r}
kable(summary(Commune_Data))
```

```{r}
kable(summary(Dentist_Data[3:6]))
```

```{r}
kable(summary(Dentist_Data[8:12]))
```

```{r}
Commune_Data |>
  ggplot(aes(x = DistMal, y = Turnover_capita_retail, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "Turnover capita in retail per inhabitant") +
  theme_bw()
```

Might be more appropriate to explore the distance from CBDs to Malls compared to turnover capita in retail per inhabitant, rather than the distance from the geographical centroid of Norwegian Communes, because of the tendency of bigger population density around CBDs.

```{r}
Dentist_Data |>
  ggplot(aes(x = DistCBD, y = Sum.salgsi, colour = DistCBD)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from CBD", y = "Income") +
  theme_bw()
```

```{r}
Dentist_Data_LIMIT <- Dentist_Data |>
  filter(Sum.salgsi < 100000000, DistCBD < 250,
         Driftsres < 20000000, Driftsres > -10000000, DistMal < 80)
```

```{r}
Dentist_Data_LIMIT |>
  ggplot(aes(x = DistCBD, y = Sum.salgsi, colour = DistCBD)) +
  geom_point(lwd = .9) + labs(x = "Distance from CBD", y = "Income") +
  theme_bw()
```

```{r}
Dentist_Data |>
  ggplot(aes(x = DistMal, y = Driftsres, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "EBIT") +
  theme_bw()
```

```{r}
Dentist_Data_LIMIT |>
  ggplot(aes(x = DistMal, y = Driftsres, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "EBIT") +
  theme_bw()
```

## Econometric approach

After a quixk view of some of our findings where we used the dentist income (y) and in comparison to the Distance from Mall (x) we already see some signs of a pattern where the income is grater when the dentist is placed closer to the shopping mall and decreases as the distance gets bigger.
However, when the distance reach around 10km from the mall the income starts to increase before it then starts to decrease again around 20km.
The theory from Keynesian suggest that this pattern might take place as the transportation cost for individuals further from the Shopping mall does not increase to much by travelling the extra distance.
Hotelling also describes this case where the consumer are willing to travel further to reach a certain central place.

\

We also find that most dentist are either located close to a City, Central Business District or a shopping mall.

\

Dentist are also located close to echeother making for a sort of cluster, indicating that it might be som advantages beeing located in a cluster.
Taken for granted that or data on Dentist includes both \"normal Dentis\" and Spescialist, there is reason to believe that it could be an advantage beeing located close together.
As found in Marshalls Theory their ar several advantages by locating in clusters.
Where in this case a \"normal dentist\" would for example recommend one of their customers to go see a specialist to get braces.
The customer would then probably prefer to go to the closes specialist.
The access to work force in these areas would also be good and wll be whitin the same geographic area.

\
