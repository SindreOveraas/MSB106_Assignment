---
title: "MSB106 - Assignment"
author: "Sindre H. Øveraas, Alen Colakovic, Mona Lisa Jones & Sebastian M. Fløysand"
format:
 pdf:
  fontsize: "10"
  documentclass: article
  margin-left: 2cm
  margin-right: 2cm
papersize: A4
editor: visual
---

```{r, message=FALSE}
library(rgdal)
library(dplyr)
library(RSQLite)
library(sf)
library(tidyverse)
library(readr)
library(ggplot2)
library(kableExtra)
library(huxtable)
```

```{r, message=FALSE}
NOR_CBD <- read_csv("NOR_CBD.csv")
Dist_CBD_Dentist <- read_csv("Dist_CBD_Dentist.csv")
Zonal_CBD <- read_csv("Zonal_CBD.csv")
Dist_Mal_Dentist <- read.csv("Dist_Mal_Dentist.csv")
NOR_OSM_SHOP_MAL <- read.csv("NOR_OSM_SHOP_MAL.csv")
Zonal_Den <- read.csv("Zonal_Den.csv") |>
  select(fid, X_sum)
Dist_Comp_Den <- read.csv("Dist_Comp_Den.csv") |>
  select(fid, distance)
NOR_KOMM <- read_csv("NOR_KOMM.csv")
NOR_KOMM_2 <- read_csv("NOR_KOMM_2.csv")
```

```{r}
Commune_Data <- inner_join(NOR_KOMM, NOR_KOMM_2, by = "kommunenummer") |>
  select(kommunenummer, HubName, HubDist, Turnover_capita_retail_Omsetning) |>
  rename("knr" = kommunenummer, "DistMal" = HubDist, "HubNameMal" = HubName, "Turnover_capita_retail" = Turnover_capita_retail_Omsetning)
```

```{r}
Dentist_Data <- inner_join(Dist_Mal_Dentist, Dist_CBD_Dentist, by = "fid") |>
  select(fid, Juridisk.n, Antall.ans, Sum.Drifts, Sum.salgsi, Driftsresu.y, osm_id.y, latlong.y, HubName.y, HubDist.y, HubName.x, HubDist.x) |>
  rename("DistMal" = HubDist.x, "DistCBD" = HubDist.y, "HubNameMal" = HubName.x, "HubNameCBD" = HubName.y, "Driftsres" = Driftsresu.y, "osm_id" = osm_id.y, "latlong" = latlong.y)
```

```{r}
Dentist_Data <- inner_join(Dentist_Data, Zonal_Den, by = "fid")
```

```{r}
Dentist_Data <- inner_join(Dentist_Data, Dist_Comp_Den, by = "fid") |>
  rename("DistComp" = distance)
```

**Abstract**

There are several factors to take in to consideration when deciding where a dental practice should be located.
Spatial competition is a critical consideration in regional economics.
Some of the factors influencing the decision making is retail agglomeration attributes, spatial monopoly and the attractiveness of a particular place of interest.
This study aims to examine the dental industry and find the strategy most profitable for the dental industry.

The study utilize a quantitative research approach, employing spacial explanatory data analysis techniques to determine the location decisions of firms.
Geographical data was collected from locations in Norway showing all dentists, central places, retail agglomeration and other points of interest such as the government regulated wine monopoly.
Combined with regional income data a spatial regression analyses was used to identify the factors influencing the location decisions of firms.

Furthermore, the result indicates the distance to retail agglomeration areas and central places playes a significant role in the location decisions for firms.
Firms are more likely to locate closer to these areas, which offer access to a larger customer base and lower cost of transportation.
However, the results also suggest other factors, such as market size and completion also influence the location decisions for firms.

The studies findings have particular implications for policy-makers, developer, and dental practises seeking to maximize profits through strategic decisions.
By understanding the importance of proximity to retail agglomeration areas and central places, these stakeholders can make informed decisions that benefit the local economy and improve competitiveness of the region.
Perhaps more importantly prevent agrassive retail agglomeration areas from "killing down town".

## Introduction

Our main task in this assignment is to perform an analysis of geospatial determinants of firm activity.
More specifically we are to focus on the Norwegian dental industry in this regard, and see how geospatial determinants such as distances to shopping malls and CBDs (Central Business Districts), as well as population density can determine dental businesses income and general financial operations.
As an example, central questions in this assignment will be; "Is it more beneficial to be highly centralized in urban areas with high population density and many competitors, or is it a greater advantage to be less centralized to the advantage that the nearest competing company is considerably further away?", "Which determinants appear to be most significant for economic benefit?"

The theoretical framework for this study draws on Marshall's agglomeration principles, which emphasize spatial aspects of economic growth.
Hotelling's game theory is used to explain spatial competition by location.
Furthermore, adding the hybrid model whereas firms compete both in location and price, with consumers having a transportation cost and firms producing differentiated products.
Alsonso's bid-rent model and gravitational models also provides insights into how dentists or other retailer makes location decisions in the context of regional growth.

The dental industry provides an interesting industry to study for this research because of its unique characteristics.
Dental practices require a high degree of specialization and expertise.
At the same time, they need to be easily accessible to consumers.
Shopping malls and central places offer a continent location for dental practices that said competition for prime locations can be intense and push some in to spatial monopoly.

The result of this study indicates that dentist's with the highest income are usually located in central places in big cities.
The findings are in line with already exciting theories especially supporting the gravitational models and agglomeration attributes.
Proving a central location within large cities are the best location to maximize profit for Dental practices.

## Theoretical Foundation of Hypothesis

## Data description

```{r}
kable(summary(Commune_Data))
```

```{r}
kable(summary(Dentist_Data[3:6]))
```

```{r}
kable(summary(Dentist_Data[8:11]))
```

```{r}
kable(summary(Dentist_Data[11:14]))
```

```{r}
Commune_Data |>
  ggplot(aes(x = DistMal, y = Turnover_capita_retail, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "Turnover capita in retail per inhabitant") +
  theme_bw()
```

Might be more appropriate to explore the distance from CBDs to Malls compared to turnover capita in retail per inhabitant, rather than the distance from the geographical centroid of Norwegian Communes, because of the tendency of bigger population density around CBDs.

```{r}
Dentist_Data |>
  ggplot(aes(x = DistCBD, y = Sum.salgsi, colour = DistCBD)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from CBD", y = "Income") +
  theme_bw()
```

```{r}
Dentist_Data_LIMIT <- Dentist_Data |>
  filter(Sum.salgsi < 100000000, DistCBD < 250,
         Driftsres < 20000000, Driftsres > -10000000, DistMal < 80)
```

```{r}
Dentist_Data_LIMIT |>
  ggplot(aes(x = DistCBD, y = Sum.salgsi, colour = DistCBD)) +
  geom_point(lwd = .9) + labs(x = "Distance from CBD", y = "Income") +
  theme_bw()
```

```{r}
Dentist_Data |>
  ggplot(aes(x = DistMal, y = Driftsres, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "EBIT") +
  theme_bw()
```

```{r}
Dentist_Data_LIMIT |>
  ggplot(aes(x = DistMal, y = Driftsres, colour = DistMal)) +
  geom_point(lwd = .9) +
  labs(x = "Distance from Mall", y = "EBIT") +
  theme_bw()
```

```{r}
Dentist_Data_LIMIT |>
  ggplot(aes(x = X_sum, y = Sum.salgsi, colour = Sum.salgsi)) +
  geom_point(lwd = .9) +
  labs(x = "Pop density", y = "Income") +
  theme_bw()
```

```{r}
lm1 <- lm(Sum.salgsi ~ X_sum, data = Dentist_Data_LIMIT)
lm2 <- lm(Sum.salgsi ~ DistComp + DistCBD + DistMal + X_sum + (DistCBD*X_sum), data = Dentist_Data_LIMIT)
```

```{r}
huxreg(list("Model 1" = lm1, "Model 2" = lm2), statistics = c(N = "nobs", R2 = "r.squared"), const. = "(Intercept)", note = "Note: {stars} T statistics in brackets.")
```

## Econometric approach
